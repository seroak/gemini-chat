# 최적화 의사결정 가이드

월간 리포트의 분석 결과를 바탕으로 실제 Rule/Skill을 수정할 때 참조하는 상세 가이드.

---

## 의사결정 플로우

```
Rule/Skill 분석 결과
│
├── 트리거율 0% (3개월 연속)
│   ├── 해당 기술을 프로젝트에서 사용하나?
│   │   ├── NO → 🗑️ 삭제
│   │   └── YES → 글로브 패턴 재검토
│   │       ├── 패턴 문제 → 🔧 글로브 수정
│   │       └── 패턴 정상 → 📦 manual로 변경 (필요 시만 로드)
│
├── 트리거율 높음 + 유용률 낮음
│   ├── alwaysApply인가?
│   │   ├── YES → 내용 축소 또는 globs로 변경
│   │   └── NO → 내용 재검토 / 실제 필요한 부분만 남기기
│
├── 트리거율 낮음 + 유용률 높음
│   └── ✅ 유지 (전문 영역에서 가치 있음)
│
├── 두 Rule이 항상 함께 트리거됨
│   └── 🔗 병합 검토
│
└── Skill 완료율 낮음
    ├── 워크플로가 너무 복잡한가?
    │   ├── YES → 단순화
    │   └── NO → 트리거 키워드 부정확 → description 수정
```

---

## 시나리오별 상세 가이드

### 시나리오 1: alwaysApply Rule의 유용률이 낮을 때

**증상**: 매 세션 트리거되지만 50% 이상에서 "무관" 판정

**진단 절차**:
1. Rule 내용 중 어떤 부분이 유용한지 세션별로 확인
2. 유용한 부분만 추출

**처방**:
- 유용한 내용만 남기고 줄 수 축소
- 특정 파일 유형에서만 유용한 경우 → globs로 전환
- 전체적으로 불필요한 경우 → 삭제 검토

**주의**: alwaysApply 총량 70줄 한도를 반드시 유지

### 시나리오 2: globs Rule이 전혀 트리거되지 않을 때

**증상**: 특정 Rule이 1개월 이상 트리거 0%

**진단 절차**:
1. 해당 글로브 패턴과 실제 작업 파일 경로 비교
2. 해당 기술을 프로젝트에서 사용 중인지 확인
3. 비슷한 작업에서 다른 Rule이 대신 사용되었는지 확인

**처방**:
| 원인 | 처방 |
|------|------|
| 글로브 패턴 불일치 | 패턴 수정 (실제 파일 경로 기반) |
| 해당 영역 작업 없음 | 유지 (일시적일 수 있음) |
| 3개월 연속 미사용 | manual로 전환 또는 삭제 |
| 다른 Rule에 흡수됨 | 병합 후 삭제 |

### 시나리오 3: 두 Rule이 항상 함께 트리거될 때

**증상**: Rule A와 Rule B의 트리거 패턴이 90%+ 일치

**진단 절차**:
1. 두 Rule의 글로브 패턴 비교
2. 내용의 중복도 확인
3. 병합 시 50줄 한도 초과 여부 확인

**처방**:
- 병합 후 50줄 이하 → 병합
- 병합 후 50줄 초과 → 유지 (또는 내용 축소 후 병합)
- 내용이 완전히 다른 주제 → 유지

### 시나리오 4: Skill 완료율이 낮을 때

**증상**: Skill이 트리거되지만 워크플로가 중간에 중단됨

**진단 절차**:
1. 어느 단계에서 중단되는지 확인
2. 사용자가 중간에 방향을 변경한 건지, 워크플로가 부적절한 건지 구분

**처방**:
| 원인 | 처방 |
|------|------|
| 워크플로가 너무 길다 | 핵심 단계만 남기고 선택적 단계 분리 |
| 참조 파일이 너무 크다 | 참조 파일 축소 |
| 실제 필요와 미스매치 | description과 워크플로 재설계 |

### 시나리오 5: Skill이 전혀 사용되지 않을 때

**증상**: 2개월 이상 트리거 0회

**진단 절차**:
1. 해당 워크플로가 실제로 발생하는지 확인
2. description의 트리거 키워드가 실제 사용자 요청과 매칭되는지 확인
3. 에이전트가 자동 트리거해야 하는 상황에서 누락되는지 확인

**처방**:
| 원인 | 처방 |
|------|------|
| 트리거 키워드 부정확 | description 수정 |
| 워크플로 자체가 불필요 | 삭제 |
| 다른 방법으로 해결 중 | 유지하되 모니터링 |

---

## 변경 실행 체크리스트

Rule/Skill을 변경할 때 반드시 확인:

- [ ] 변경 전 현재 상태 기록 (줄 수, 적용 방식)
- [ ] alwaysApply Rule 총량이 70줄 이하인지 확인
- [ ] 개별 Rule이 50줄 이하인지 확인
- [ ] 글로브 패턴이 의도한 파일과 매칭되는지 확인
- [ ] 삭제하는 Rule의 내용 중 다른 곳에서 필요한 부분이 없는지 확인
- [ ] 변경 사항을 CONTEXT-MANAGEMENT-PLAN.md 체크리스트에 반영
- [ ] 변경 사항을 git 커밋

---

## 분기별 종합 리뷰 (3개월마다)

분기별로 아래 항목을 점검:

1. **전체 Rule 수**: 과도하게 늘어났는지 (15~20개 적정)
2. **alwaysApply 총량**: 70줄 한도 준수
3. **Skill 수**: 실제 사용되는 Skill만 유지 (4~8개 적정)
4. **F 등급 항목**: 3개월 연속 F 등급이면 삭제
5. **신규 패턴 발견**: 반복되는 작업이 Rule/Skill로 캡슐화되지 않았는지
